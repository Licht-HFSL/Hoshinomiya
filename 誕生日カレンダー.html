<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Character Birthday Calendar</title>
  <link rel="stylesheet" href="誕生日カレンダー.css">
</head>

 <!-- ヘッダー -->
  <header>
    <nav>
      <a href="index.html">トップ</a>
      <a href="characters.html">キャラクター図鑑</a>
      <a href="Лаплавень.html">Лаплавень</a>
      <a href="World WAR a VisiON.html">World WAR a VisiON</a>
      <a href="妖行脚百鬼夜行物語.html">妖行脚百鬼夜行物語</a>
      <a href="不毛論争.html">不毛論争</a>
      <a href="Lisnoir.html">Lisnoir</a>
      <!-- 必要に応じて作品を追加 -->
    </nav>
  </header>


<body>
  <h1>Character Birthday Calendar</h1>
  <dd>日付選択すると下部に拡大表示されます</dd>

  <div class="calendar-container">
    <div class="calendar-header">
      <button id="prevMonth">←</button>
      <h2 id="monthYear"></h2>
      <button id="nextMonth">→</button>
    </div>

    <div class="calendar-grid" id="calendarGrid"></div>
  </div>


  <!-- 誕生日データ -->
  <div id="birthdays" style="display:none">
   
  </div>

<div id="birthdayDetails" class="birthday-details"></div>


 <script>
const calendarGrid = document.getElementById('calendarGrid');
const monthYear = document.getElementById('monthYear');
const prevMonthBtn = document.getElementById('prevMonth');
const nextMonthBtn = document.getElementById('nextMonth');

let characters = [];

fetch('characters.json')  // キャラ管理用JSON
  .then(res => res.json())
  .then(data => {
    characters = data;
    updateCalendar();
  });

let today = new Date();
let currentMonth = today.getMonth();
let currentYear = today.getFullYear();

function renderCalendar(year, month) {
  calendarGrid.innerHTML = '';
  const firstDay = new Date(year, month, 1).getDay();
  const lastDate = new Date(year, month + 1, 0).getDate();

  monthYear.textContent = `${year}年 ${month + 1}月`;

  // 空白セル
  for (let i = 0; i < firstDay; i++) {
    const empty = document.createElement('div');
    empty.classList.add('date');
    calendarGrid.appendChild(empty);
  }

  for (let i = 1; i <= lastDate; i++) {
    const date = document.createElement('div');
    date.classList.add('date');
    date.dataset.day = i;
    date.dataset.month = month + 1;

    // 当日のキャラを取得
    const group = characters.filter(c => {
      if (!c.birthday) return false;
      const [bMonth, bDay] = c.birthday.split('/').map(Number);
      return bMonth === month + 1 && bDay === i;
    });

    // 当日キャラのアイコンを日付セルに追加（任意、最大4個まで）
    let count = 0;
    group.forEach(c => {
      if ((c.birthdayicon ) && count < 4) {
        const img = document.createElement('img');
        img.src = c.birthdayicon ;
        img.alt = c.name;
        img.title = c.name;
        img.classList.add('birthday-icon');
        date.appendChild(img);
        count++;
      }
    });

    // 日付セルクリックで下のパネルに全員表示
    date.addEventListener('click', () => {
      const birthdayDetails = document.getElementById('birthdayDetails');
      birthdayDetails.innerHTML = ''; // まずクリア
      group.forEach(c => {
        if (c.birthdayicon) {
      const container = document.createElement('div');
      container.classList.add('character-detail');

      const detailImg = document.createElement('img');
      detailImg.src = c.birthdayicon || c.icon;
      detailImg.alt = c.name;
      detailImg.title = c.name;
      detailImg.classList.add('birthday-icon');

      const nameText = document.createElement('p');
      nameText.textContent = c.name;
      nameText.classList.add('character-name');

      container.appendChild(detailImg);
      container.appendChild(nameText);
      birthdayDetails.appendChild(container);

        }
      });

      birthdayDetails.style.display = group.length > 0 ? 'block' : 'none';
    });

    calendarGrid.appendChild(date);
  }
}


function updateCalendar() {
  renderCalendar(currentYear, currentMonth);
}

prevMonthBtn.addEventListener('click', () => {
  currentMonth--;
  if (currentMonth < 0) {
    currentMonth = 11;
    currentYear--;
  }
  updateCalendar();
});

nextMonthBtn.addEventListener('click', () => {
  currentMonth++;
  if (currentMonth > 11) {
    currentMonth = 0;
    currentYear++;
  }
  updateCalendar();
});

</script>

 <footer>© 2025 Licht</footer>

</body>
</html>
