<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">  <!-- â† ã“ã‚Œã‚’è¿½åŠ  -->
  <title>ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å›³é‘‘</title>
 <link rel="stylesheet" href="characters.css"> <!-- CSSã‚’å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã§èª­ã¿è¾¼ã¿ -->

</head>
<body>
  <h1>ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å›³é‘‘</h1>

 <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <header>
    <nav>
      <a href="index.html">ãƒˆãƒƒãƒ—</a>
      <a href="Ğ›Ğ°Ğ¿Ğ»Ğ°Ğ²ĞµĞ½ÑŒ.html">Ğ›Ğ°Ğ¿Ğ»Ğ°Ğ²ĞµĞ½ÑŒ</a>
      <a href="World WAR a VisiON.html">World WAR a VisiON</a>
      <a href="å¦–è¡Œè„šç™¾é¬¼å¤œè¡Œç‰©èª.html">å¦–è¡Œè„šç™¾é¬¼å¤œè¡Œç‰©èª</a>
      <a href="ä¸æ¯›è«–äº‰.html">ä¸æ¯›è«–äº‰</a>
      <a href="Lisnoir.html">Lisnoir</a>
      <a href="è–ç°ã®Vampire.html">è–ç°ã®Vampire</a>
      <!-- å¿…è¦ã«å¿œã˜ã¦ä½œå“ã‚’è¿½åŠ  -->
    </nav>
  </header>


  <!-- ğŸ” æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ  -->
  <div class="filters">
    <input type="text" id="searchBox" placeholder="åå‰ã§æ¤œç´¢">
    <select id="filterWorld">
      <option value="">ä½œå“ï¼ˆã™ã¹ã¦ï¼‰</option>
    </select>
    <select id="filterAffiliation">
      <option value="">æ‰€å±ï¼ˆã™ã¹ã¦ï¼‰</option>
    </select>
    <select id="filterAttr">
      <option value="">å±æ€§ï¼ˆã™ã¹ã¦ï¼‰</option>
    </select>
    <select id="filterGender">
      <option value="">æ€§åˆ¥ï¼ˆã™ã¹ã¦ï¼‰</option>
    </select>
  </div>

  <!-- ã‚­ãƒ£ãƒ©ä¸€è¦§ -->
  <div class="character-list" id="characterList">
    <!-- ã“ã“ã«ã‚­ãƒ£ãƒ©ã‚«ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã‚‹ï¼ˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‹ã‚‰ç”Ÿæˆã—ãŸHTMLï¼‰ -->




   <script>

const WORLDER = [
  'Ğ›Ğ°Ğ¿Ğ»Ğ°Ğ²ĞµĞ½ÑŒ','World WAR a VisiON','å¦–è¡Œè„šç™¾é¬¼å¤œè¡Œç‰©èª','ä¸æ¯›è«–äº‰','Lisnoir','è–ç°ã®Vampire','æ˜Ÿæµ·ã®ã‚µãƒ«ãƒ´ã‚¡ãƒˆãƒ¼ãƒ¬','é¡æ¥½å›ä¸»','TRPG'
];

const AFFILIATION = [
// Ğ›Ğ°Ğ¿Ğ»Ğ°Ğ²ĞµĞ½ÑŒ
  'æ˜Ÿå…‰ã®å­','ç¥æ§˜','æ—¥æœ¬ç¥è©±','å¤©ä½¿','æ‚ªé­”','é­”ç‰©',
// World WAR a VisiONã€€ä¸æ¯›è«–äº‰
  'ã‚¢ãƒ¡ãƒªã‚«','ã‚¤ã‚®ãƒªã‚¹','ãƒ•ãƒ©ãƒ³ã‚¹','ãƒ‰ã‚¤ãƒ„','ã‚¤ã‚¿ãƒªã‚¢','æ—¥æœ¬','ã‚½ãƒ“ã‚¨ãƒˆ','ä¸­è¯æ°‘å›½','ãƒ•ã‚£ãƒ³ãƒ©ãƒ³ãƒ‰','ãƒ«ãƒ¼ãƒãƒ‹ã‚¢',
// å¦–è¡Œè„šç™¾é¬¼å¤œè¡Œç‰©èª
  'æ¡œçµ„','æ¤¿çµ„','äº¬','æ±Ÿæˆ¸','æ”¾æµª','å¤§æ±Ÿå±±','éˆ´é¹¿å±±','ä¼Šå¹å±±','ç¥æ ¼','æ‚ªé¬¼','é›…è¡†','çœŸå®µè¡†','åœ°ç„','ä¸ƒä»™é¬¼','åäºŒå¤©å°†','å¤§è›‡å…«å‚‘','ã‚ãã‚åºµ','æœˆã®å®®','ç‰å…','ãƒãƒ³ãƒ‰',
// Lisnoir
  'é»’ç™¾åˆ','ç™½ç™¾åˆ',
// è–ç°ã®Vampire
  'è–æ•™ä¼š','å§‹ç¥–','çœ·å±',
// æ˜Ÿæµ·ã®ã‚µãƒ«ãƒ´ã‚¡ãƒˆãƒ¼ãƒ¬
  'å‰µæ¦‚','ç•°ç•Œæ¸¡ã‚Š',
];

const ATTR_ORDER = [
  'ç«å±æ€§','é›·å±æ€§','æ°´å±æ€§','æ°·å±æ€§','æœ¨å±æ€§','é¢¨å±æ€§','åœŸå±æ€§','å²©å±æ€§','ç„¡å±æ€§','å…‰å±æ€§','é—‡å±æ€§','æ—¥å±æ€§','æœˆå±æ€§','æ˜Ÿå±æ€§'
];

const GENDER_ORDER = [
  'ç”·æ€§','å¥³æ€§','ç„¡'
];

let allCharacters = [];

    // JSONãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿
    async function loadCharacters() {
      const res = await fetch("characters.json"); // JSONãƒ•ã‚¡ã‚¤ãƒ«åã‚’åˆã‚ã›ã¦ã­
      const characters = await res.json();
      allCharacters = characters; // â˜…ä¿æŒ
      renderCharacters(characters);
      populateFilters(characters);
    }

    // HTMLã«ã‚­ãƒ£ãƒ©ã‚’æç”»
    function renderCharacters(characters) {
      const container = document.getElementById("characterList");
      container.innerHTML = "";

      characters.forEach(c => {
        const card = document.createElement("div");
        card.className = "character-card";
        card.dataset.name = c.name;
        card.dataset.world = c.world;
        card.dataset.affiliation = c.affiliation || c.aaffiliation || "";
        card.dataset.attr = c.attribute;
        card.dataset.gender = c.gender;

        card.innerHTML = `
        <a href="${c.detailUrl}">
          <img src="${c.image}" alt="${c.name}">
          <h3>${c.name}</h3>
         </a>
        `;
        container.appendChild(card);

        
      });
    }

    // ãƒ•ã‚£ãƒ«ã‚¿é …ç›®ã‚’ä½œæˆ
    function populateFilters(characters) {
      const worlds = new Set();
      const affiliations = new Set();
      const attrs = new Set();
      const genders = new Set();

      characters.forEach(c => {
        if (c.world) worlds.add(c.world);
        if (c.affiliation || c.aaffiliation) affiliations.add(c.affiliation || c.aaffiliation);
        if (c.attribute) attrs.add(c.attribute);
        if (c.gender) genders.add(c.gender);
      });

      function fillSelect(id, values) {
        const select = document.getElementById(id);
        [...values].forEach(v => {
          const opt = document.createElement("option");
          opt.value = v;
          opt.textContent = v;
          select.appendChild(opt);
        });
      }

updateAffiliationByWorld('');


      fillSelect("filterWorld", WORLDER);
      fillSelect("filterAttr", ATTR_ORDER);
      fillSelect("filterGender", GENDER_ORDER);
    }

    function updateAffiliationByWorld(world) {
  const select = document.getElementById("filterAffiliation");

  // ä»Šã®é¸æŠã‚’é€€é¿
  const current = select.value;

  // åˆæœŸåŒ–
  select.innerHTML = '<option value="">æ‰€å±ï¼ˆã™ã¹ã¦ï¼‰</option>';

  // å¯¾è±¡ã‚­ãƒ£ãƒ©ã‚’çµã‚‹
  const targets = world
    ? allCharacters.filter(c => c.world === world)
    : allCharacters;

  // æ‰€å±ã‚’æŠ½å‡ºï¼ˆé‡è¤‡é˜²æ­¢ï¼‰
  const set = new Set();
  targets.forEach(c => {
    const a = c.affiliation || c.aaffiliation;
    if (a) set.add(a);
  });

  // AFFILIATION ã®é †ç•ªã‚’ç¶­æŒã—ã¦è¿½åŠ 
  AFFILIATION.forEach(a => {
    if (set.has(a)) {
      const opt = document.createElement("option");
      opt.value = a;
      opt.textContent = a;
      select.appendChild(opt);
    }
  });

  // ã¾ã æœ‰åŠ¹ãªã‚‰é¸æŠã‚’å¾©å…ƒ
  if ([...select.options].some(o => o.value === current)) {
    select.value = current;
  }
}


    // ãƒ•ã‚£ãƒ«ã‚¿æ©Ÿèƒ½
    function filterCharacters() {
      const search = document.getElementById('searchBox').value.toLowerCase();
      const world = document.getElementById('filterWorld').value;
      const affiliation = document.getElementById('filterAffiliation').value;
      const attr = document.getElementById('filterAttr').value;
      const gender = document.getElementById('filterGender').value;

      document.querySelectorAll('.character-card').forEach(card => {
        const match =
          card.dataset.name.toLowerCase().includes(search) &&
          (!world || card.dataset.world === world) &&
          (!affiliation || card.dataset.affiliation === affiliation) &&
          (!attr || card.dataset.attr === attr) &&
          (!gender || card.dataset.gender === gender);

        card.style.display = match ? 'block' : 'none';
      });
    }

document.addEventListener("input", e => {
  if (!e.target.closest(".filters")) return;

  // ãƒ¯ãƒ¼ãƒ«ãƒ‰ãŒå¤‰ã‚ã£ãŸã‚‰æ‰€å±ã‚’æ›´æ–°
  if (e.target.id === "filterWorld") {
    updateAffiliationByWorld(e.target.value);
  }

  filterCharacters();
});


    document.addEventListener("DOMContentLoaded", loadCharacters);
  </script>

</body>
</html>

